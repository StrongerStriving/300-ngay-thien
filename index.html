<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>300-Day Meditation Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #e7f5ff; /* Xanh d∆∞∆°ng nh·∫°t pastel */
            color: #333;
        }
        header {
            background-color: #b5e48c; /* Xanh l√° pastel */
            color: white;
            padding: 1rem 0;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .container {
            max-width: 900px;
            margin: 1rem auto;
            padding: 1rem;
            background: #ffffff; /* Tr·∫Øng pastel */
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .row {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .row .date {
            width: 100%;
            font-weight: bold;
            text-align: left;
            color: #0077b6;
            margin-bottom: 0.5rem;
        }
        @media (min-width: 600px) {
            .row .date {
                width: 150px;
                margin-bottom: 0;
            }
        }
        .row .days {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5 c·ªôt tr√™n m√†n h√¨nh nh·ªè */
            gap: 0.5rem;
            flex-grow: 1;
        }
        @media (min-width: 600px) {
            .row .days {
                grid-template-columns: repeat(10, 1fr); /* 10 c·ªôt tr√™n m√†n h√¨nh l·ªõn */
            }
        }
        .day {
            text-align: center;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background-color: #caf0f8; /* Xanh d∆∞∆°ng pastel */
            transition: all 0.3s ease;
        }
        .day.completed {
            background-color: #76c893; /* Xanh l√° pastel ƒë·∫≠m */
            color: white;
            border: 1px solid #0077b6;
        }
        .streak {
            margin-top: 1rem;
            font-size: 1.2rem;
            text-align: center;
            color: #0077b6;
        }
        .message {
            margin-top: 1rem;
            text-align: center;
            font-size: 1.5rem;
            color: #0077b6;
        }
        .notes {
            margin-top: 2rem;
        }
        .note-item {
            margin-bottom: 1rem;
            padding: 0.8rem;
            background-color: #f0f8ff; /* Tr·∫Øng xanh pastel */
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 2rem;
        }
        .buttons button {
            width: 90%;
            max-width: 300px;
            padding: 0.8rem;
            margin: 0.5rem 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            background-color: #0077b6; /* Xanh d∆∞∆°ng ƒë·∫≠m */
            color: white;
            transition: background-color 0.3s ease;
        }
        .buttons button:hover {
            background-color: #023e8a; /* Xanh d∆∞∆°ng ƒë·∫≠m h∆°n */
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .modal-buttons button {
            margin: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        .modal-buttons button:first-child {
            background-color: #0077b6;
            color: white;
        }
        .modal-buttons button:last-child {
            background-color: #ddd;
            color: #333;
        }
    </style>
</head>
<body>
    <header>
        300-Day Meditation Tracker
    </header>
    <div class="container">
        <div id="tracker">
            <!-- C√°c h√†ng s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
        </div>
        <div class="streak" id="streak">Chu·ªói ng√†y li√™n t·ª•c: 0</div>
        <div class="message" id="message"></div>
        <div class="notes" id="notes">
            <h3>Ghi ch√∫:</h3>
        </div>
        <div class="buttons">
            <button id="set-start-date">Thi·∫øt L·∫≠p Ng√†y B·∫Øt ƒê·∫ßu</button>
            <button id="reset-data">X√≥a D·ªØ Li·ªáu</button>
        </div>
    </div>
    <!-- Modal Popup -->
    <div id="meditation-modal" class="modal">
        <div class="modal-content">
            <h3>H√¥m nay b·∫°n ƒë√£ thi·ªÅn nh∆∞ th·∫ø n√†o?</h3>
            <textarea id="meditation-note" placeholder="Nh·∫≠p c·∫£m nh·∫≠n c·ªßa b·∫°n t·∫°i ƒë√¢y..."></textarea>
            <div class="modal-buttons">
                <button id="save-meditation-note">L∆∞u</button>
                <button id="cancel-meditation-note">H·ªßy</button>
            </div>
        </div>
    </div>
    <script>
        const tracker = document.getElementById('tracker');
        const streakDisplay = document.getElementById('streak');
        const messageDisplay = document.getElementById('message');
        const notesSection = document.getElementById('notes');
        const setStartDateButton = document.getElementById('set-start-date');
        const resetButton = document.getElementById('reset-data');
        const modal = document.getElementById('meditation-modal');
        const noteTextarea = document.getElementById('meditation-note');
        const saveNoteButton = document.getElementById('save-meditation-note');
        const cancelNoteButton = document.getElementById('cancel-meditation-note');

        let meditationData = JSON.parse(localStorage.getItem('meditationData')) || {};
        let dailyNotes = JSON.parse(localStorage.getItem('dailyNotes')) || {};
        let startDate = localStorage.getItem('startDate') ? new Date(localStorage.getItem('startDate')) : new Date();
        let selectedDayKey = null;

        function saveMeditationData() {
            localStorage.setItem('meditationData', JSON.stringify(meditationData));
        }

        function saveDailyNotes() {
            localStorage.setItem('dailyNotes', JSON.stringify(dailyNotes));
        }

        function saveStartDate() {
            localStorage.setItem('startDate', startDate.toISOString());
        }

        function generateTracker() {
            tracker.innerHTML = '';
            let currentDate = new Date(startDate);

            for (let row = 1; row <= 30; row++) {
                const rowElement = document.createElement('div');
                rowElement.className = 'row';

                // Hi·ªÉn th·ªã ng√†y ƒë·∫ßu c·ªßa m·ªói h√†ng
                const dateElement = document.createElement('div');
                dateElement.className = 'date';
                dateElement.textContent = currentDate.toLocaleDateString('vi-VN');
                rowElement.appendChild(dateElement);

                // T·∫°o 10 √¥ cho m·ªói h√†ng
                const daysElement = document.createElement('div');
                daysElement.className = 'days';

                for (let col = 1; col <= 10; col++) {
                    const dayNumber = (row - 1) * 10 + col;
                    const dayKey = `day-${dayNumber}`;
                    const dayElement = document.createElement('div');
                    dayElement.className = `day ${meditationData[dayKey] ? 'completed' : ''}`;
                    dayElement.textContent = dayNumber;
                    dayElement.addEventListener('click', () => toggleDay(dayKey, dayElement));
                    daysElement.appendChild(dayElement);
                }

                // TƒÉng ng√†y l√™n 10
                currentDate.setDate(currentDate.getDate() + 10);

                rowElement.appendChild(daysElement);
                tracker.appendChild(rowElement);
            }
        }

        function toggleDay(dayKey, element) {
            if (!meditationData[dayKey]) {
                selectedDayKey = dayKey;
                modal.style.display = 'flex';
            } else {
                delete meditationData[dayKey];
                element.classList.remove('completed');
                saveMeditationData();
                updateStreak();
            }
        }

        saveNoteButton.addEventListener('click', () => {
            const note = noteTextarea.value.trim();
            if (note) {
                const timestamp = new Date().toLocaleString('vi-VN');
                meditationData[selectedDayKey] = true;
                dailyNotes[selectedDayKey] = { note, timestamp };
                saveMeditationData();
                saveDailyNotes();
                modal.style.display = 'none';
                noteTextarea.value = '';
                generateTracker();
                updateStreak();
                renderNotes();
            }
        });

        cancelNoteButton.addEventListener('click', () => {
            modal.style.display = 'none';
            noteTextarea.value = '';
        });

        function renderNotes() {
            notesSection.innerHTML = '<h3>Ghi ch√∫:</h3>';
            Object.keys(dailyNotes).forEach(dayKey => {
                const { note, timestamp } = dailyNotes[dayKey];
                const noteItem = document.createElement('div');
                noteItem.className = 'note-item';
                noteItem.textContent = `Ng√†y ${dayKey.split('-')[1]} (${timestamp}): ${note}`;
                notesSection.appendChild(noteItem);
            });
        }

        function updateStreak() {
            let streak = 0;
            let maxStreak = 0;
            let previousDay = 0;

            const completedDays = Object.keys(meditationData)
                .filter(dayKey => meditationData[dayKey])
                .map(dayKey => parseInt(dayKey.split('-')[1]))
                .sort((a, b) => a - b);

            completedDays.forEach(day => {
                if (previousDay === 0 || day === previousDay + 1) {
                    streak++;
                } else {
                    streak = 1;
                }
                maxStreak = Math.max(maxStreak, streak);
                previousDay = day;
            });

            streakDisplay.textContent = `Chu·ªói ng√†y li√™n t·ª•c: ${maxStreak}`;
            checkMilestones(maxStreak);
        }

        function checkMilestones(streak) {
            const milestones = [10, 40, 80, 100];
            if (milestones.includes(streak)) {
                messageDisplay.textContent = `üéâ Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒë·∫°t m·ªëc ${streak} ng√†y li√™n ti·∫øp! üéâ`;
            } else {
                messageDisplay.textContent = '';
            }
        }

        setStartDateButton.addEventListener('click', () => {
            const newDate = prompt('Nh·∫≠p ng√†y b·∫Øt ƒë·∫ßu (YYYY-MM-DD):');
            if (newDate) {
                startDate = new Date(newDate);
                saveStartDate();
                generateTracker();
                updateStreak();
                renderNotes();
            }
        });

        resetButton.addEventListener('click', () => {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu kh√¥ng?')) {
                localStorage.clear();
                meditationData = {};
                dailyNotes = {};
                startDate = new Date();
                generateTracker();
                updateStreak();
                renderNotes();
            }
        });

        generateTracker();
        updateStreak();
        renderNotes();
    </script>
</body>
</html>
