<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>300-Day Meditation Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #e7f5ff; /* Xanh d∆∞∆°ng nh·∫°t pastel */
            color: #333;
        }
        header {
            background-color: #b5e48c; /* Xanh l√° pastel */
            color: white;
            padding: 1rem 0;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .container {
            max-width: 900px;
            margin: 1rem auto;
            padding: 1rem;
            background: #ffffff; /* Tr·∫Øng pastel */
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .row {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .row .date {
            width: 100%;
            font-weight: bold;
            text-align: left;
            color: #0077b6;
            margin-bottom: 0.5rem;
        }
        @media (min-width: 600px) {
            .row .date {
                width: 150px;
                margin-bottom: 0;
            }
        }
        .row .days {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5 c·ªôt tr√™n m√†n h√¨nh nh·ªè */
            gap: 0.5rem;
            flex-grow: 1;
        }
        @media (min-width: 600px) {
            .row .days {
                grid-template-columns: repeat(10, 1fr); /* 10 c·ªôt tr√™n m√†n h√¨nh l·ªõn */
            }
        }
        .day {
            text-align: center;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            background-color: #caf0f8; /* Xanh d∆∞∆°ng pastel */
            transition: all 0.3s ease;
        }
        .day.completed {
            background-color: #76c893; /* Xanh l√° pastel ƒë·∫≠m */
            color: white;
            border: 1px solid #0077b6;
        }
        .streak {
            margin-top: 1rem;
            font-size: 1.2rem;
            text-align: center;
            color: #0077b6;
        }
        .message {
            margin-top: 1rem;
            text-align: center;
            font-size: 1.5rem;
            color: #0077b6;
        }
        .notes {
            margin-top: 2rem;
        }
        .notes textarea {
            width: 100%;
            height: 100px;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            resize: none;
            background-color: #f0f8ff; /* Tr·∫Øng xanh pastel */
        }
        .buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 2rem;
        }
        .buttons button {
            width: 90%;
            max-width: 300px;
            padding: 0.8rem;
            margin: 0.5rem 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            background-color: #0077b6; /* Xanh d∆∞∆°ng ƒë·∫≠m */
            color: white;
            transition: background-color 0.3s ease;
        }
        .buttons button:hover {
            background-color: #023e8a; /* Xanh d∆∞∆°ng ƒë·∫≠m h∆°n */
        }
    </style>
</head>
<body>
    <header>
        300-Day Meditation Tracker
    </header>
    <div class="container">
        <!-- Khung pop-up ghi ch√∫ -->
<div id="note-popup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #ffffff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); padding: 1rem; z-index: 1000;">
    <h3>Ghi ch√∫ c·∫£m nh·∫≠n</h3>
    <textarea id="popup-note" placeholder="Nh·∫≠p c·∫£m nh·∫≠n c·ªßa b·∫°n t·∫°i ƒë√¢y..." style="width: 100%; height: 100px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; resize: none;"></textarea>
    <div style="margin-top: 1rem; text-align: right;">
        <button id="save-popup-note" style="padding: 0.5rem 1rem; background-color: #0077b6; color: white; border: none; border-radius: 4px; cursor: pointer;">L∆∞u Ghi Ch√∫</button>
        <button id="close-popup" style="padding: 0.5rem 1rem; background-color: #ddd; color: #333; border: none; border-radius: 4px; cursor: pointer; margin-left: 0.5rem;">H·ªßy</button>
    </div>
</div>
<!-- Overlay ƒë·ªÉ l√†m m·ªù n·ªÅn khi hi·ªÉn th·ªã pop-up -->
<div id="popup-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 999;"></div>

        <div id="tracker">
            <!-- C√°c h√†ng s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
        </div>
        <div class="streak" id="streak">Chu·ªói ng√†y li√™n t·ª•c: 0</div>
        <div class="message" id="message"></div>
        <div class="notes">
            <h3>Ghi ch√∫ c·∫£m nh·∫≠n:</h3>
            <textarea id="daily-note" placeholder="Nh·∫≠p c·∫£m nh·∫≠n c·ªßa b·∫°n t·∫°i ƒë√¢y..."></textarea>
        </div>
        <div class="buttons">
            <button id="save-note">L∆∞u Ghi Ch√∫</button>
            <button id="reset-data">X√≥a D·ªØ Li·ªáu</button>
            <button id="set-start-date">Thi·∫øt L·∫≠p Ng√†y B·∫Øt ƒê·∫ßu</button>
        </div>
    </div>
    <script>
        const tracker = document.getElementById('tracker');
        const streakDisplay = document.getElementById('streak');
        const messageDisplay = document.getElementById('message');
        const noteInput = document.getElementById('daily-note');
        const saveNoteButton = document.getElementById('save-note');
        const resetButton = document.getElementById('reset-data');
        const setStartDateButton = document.getElementById('set-start-date');

        // Ng√†y b·∫Øt ƒë·∫ßu
        let startDate = new Date(localStorage.getItem('startDate')) || new Date(2025, 0, 13);

        // L·∫•y d·ªØ li·ªáu t·ª´ localStorage
        let meditationData = JSON.parse(localStorage.getItem('meditationData')) || {};
        let dailyNotes = JSON.parse(localStorage.getItem('dailyNotes')) || {};

        // H√†m l∆∞u d·ªØ li·ªáu v√†o localStorage
        function saveMeditationData() {
            localStorage.setItem('meditationData', JSON.stringify(meditationData));
        }

        function saveDailyNotes() {
            localStorage.setItem('dailyNotes', JSON.stringify(dailyNotes));
        }

        function saveStartDate() {
            localStorage.setItem('startDate', startDate.toISOString());
        }

        // H√†m t·∫°o danh s√°ch 300 ng√†y
        function generateTracker() {
            tracker.innerHTML = '';
            let currentDate = new Date(startDate);

            for (let row = 1; row <= 30; row++) {
                const rowElement = document.createElement('div');
                rowElement.className = 'row';

                // Hi·ªÉn th·ªã ng√†y ƒë·∫ßu c·ªßa m·ªói h√†ng
                const dateElement = document.createElement('div');
                dateElement.className = 'date';
                dateElement.textContent = currentDate.toLocaleDateString('vi-VN');
                rowElement.appendChild(dateElement);

                // T·∫°o 10 √¥ cho m·ªói h√†ng
                const daysElement = document.createElement('div');
                daysElement.className = 'days';

                for (let col = 1; col <= 10; col++) {
                    const dayNumber = (row - 1) * 10 + col; // S·ªë ng√†y t·ª´ 1 ƒë·∫øn 300
                    const dayKey = `day-${dayNumber}`;
                    const dayElement = document.createElement('div');
                    dayElement.className = `day ${meditationData[dayKey] ? 'completed' : ''}`;
                    dayElement.textContent = dayNumber;
                    dayElement.addEventListener('click', () => toggleDay(dayKey, dayElement));
                    daysElement.appendChild(dayElement);

                    // TƒÉng ng√†y l√™n 1
                    currentDate.setDate(currentDate.getDate() + 1);
                }

                rowElement.appendChild(daysElement);
                tracker.appendChild(rowElement);
            }
        }

        // H√†m toggle tr·∫°ng th√°i c·ªßa m·ªôt ng√†y
        function toggleDay(dayKey, element) {
            if (!meditationData[dayKey]) {
                meditationData[dayKey] = true;
                element.classList.add('completed');
            } else {
                delete meditationData[dayKey];
                element.classList.remove('completed');
            }
            saveMeditationData();
            updateStreak();
        }

        // H√†m t√≠nh chu·ªói ng√†y li√™n t·ª•c
        function updateStreak() {
            let streak = 0;
            let maxStreak = 0;
            let previousDay = 0;

            const completedDays = Object.keys(meditationData)
                .filter(dayKey => meditationData[dayKey])
                .map(dayKey => parseInt(dayKey.split('-')[1]))
                .sort((a, b) => a - b);

            completedDays.forEach(day => {
                if (previousDay === 0 || day === previousDay + 1) {
                    streak++;
                } else {
                    streak = 1;
                }
                maxStreak = Math.max(maxStreak, streak);
                previousDay = day;
            });

            streakDisplay.textContent = `Chu·ªói ng√†y li√™n t·ª•c: ${maxStreak}`;
            checkMilestones(maxStreak);
        }

        // H√†m ki·ªÉm tra c√°c m·ªëc quan tr·ªçng
        function checkMilestones(streak) {
            const milestones = [10, 40, 80, 100];
            if (milestones.includes(streak)) {
                messageDisplay.textContent = `üéâ Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒë·∫°t m·ªëc ${streak} ng√†y li√™n ti·∫øp! üéâ`;
            } else {
                messageDisplay.textContent = '';
            }
        }

        });

        // X√≥a to√†n b·ªô d·ªØ li·ªáu
        resetButton.addEventListener('click', () => {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu kh√¥ng?')) {
                localStorage.clear();
                meditationData = {};
                dailyNotes = {};
                startDate = new Date(2025, 0, 13);
                generateTracker();
                updateStreak();
            }
        });

        // Thi·∫øt l·∫≠p l·∫°i ng√†y b·∫Øt ƒë·∫ßu
        setStartDateButton.addEventListener('click', () => {
            const newDate = prompt('Nh·∫≠p ng√†y b·∫Øt ƒë·∫ßu (YYYY-MM-DD):');
            if (newDate) {
                startDate = new Date(newDate);
                saveStartDate();
                generateTracker();
                updateStreak();
            }
        });

        // Render danh s√°ch v√† c·∫≠p nh·∫≠t chu·ªói ng√†y li√™n t·ª•c l·∫ßn ƒë·∫ßu
        generateTracker();
        updateStreak();
   // Bi·∫øn tham chi·∫øu ƒë·∫øn c√°c ph·∫ßn t·ª≠ pop-up
const popup = document.getElementById('note-popup');
const overlay = document.getElementById('popup-overlay');
const popupNoteInput = document.getElementById('popup-note');
const savePopupNoteButton = document.getElementById('save-popup-note');
const closePopupButton = document.getElementById('close-popup');
let selectedDayKey = null; // L∆∞u ng√†y ƒëang ƒë∆∞·ª£c ch·ªçn

// H√†m hi·ªÉn th·ªã pop-up
function showPopup(dayKey) {
    selectedDayKey = dayKey;
    popupNoteInput.value = ''; // X√≥a n·ªôi dung c≈©
    popup.style.display = 'block';
    overlay.style.display = 'block';
}

// H√†m ·∫©n pop-up
function closePopup() {
    popup.style.display = 'none';
    overlay.style.display = 'none';
    selectedDayKey = null; // Reset ng√†y
}

// S·ª± ki·ªán ƒë√≥ng pop-up
closePopupButton.addEventListener('click', closePopup);
overlay.addEventListener('click', closePopup);

// H√†m l∆∞u ghi ch√∫ t·ª´ pop-up
savePopupNoteButton.addEventListener('click', () => {
    const noteContent = popupNoteInput.value.trim(); // L·∫•y n·ªôi dung ghi ch√∫
    if (noteContent) {
        const note = {
            date: new Date().toLocaleString('vi-VN'), // L·∫•y th·ªùi gian hi·ªán t·∫°i
            content: noteContent
        };
        if (!dailyNotes[selectedDayKey]) {
            dailyNotes[selectedDayKey] = []; // T·∫°o danh s√°ch ghi ch√∫ cho ng√†y n·∫øu ch∆∞a c√≥
        }
        dailyNotes[selectedDayKey].push(note); // Th√™m ghi ch√∫ v√†o danh s√°ch
        saveDailyNotes(); // L∆∞u v√†o localStorage
        renderNotes(); // C·∫≠p nh·∫≠t danh s√°ch ghi ch√∫
        closePopup(); // ƒê√≥ng pop-up
        alert('Ghi ch√∫ ƒë√£ ƒë∆∞·ª£c l∆∞u!');
    } else {
        alert('Vui l√≤ng nh·∫≠p n·ªôi dung ghi ch√∫!');
    }
});

// C·∫≠p nh·∫≠t toggleDay ƒë·ªÉ hi·ªÉn th·ªã pop-up sau khi ch·ªçn ng√†y
function toggleDay(dayKey, element) {
    if (!meditationData[dayKey]) {
        meditationData[dayKey] = true;
        element.classList.add('completed');
        saveMeditationData();
        updateStreak();
        showPopup(dayKey); // Hi·ªÉn th·ªã pop-up l∆∞u ghi ch√∫
    } else {
        delete meditationData[dayKey];
        element.classList.remove('completed');
        saveMeditationData();
        updateStreak();
    }
}

// H√†m hi·ªÉn th·ªã danh s√°ch ghi ch√∫
function renderNotes() {
    const savedNotesContainer = document.getElementById('saved-notes');
    savedNotesContainer.innerHTML = '<h3>Danh s√°ch ghi ch√∫:</h3>';
    Object.keys(dailyNotes).forEach(dayKey => {
        dailyNotes[dayKey].forEach(note => {
            const noteItem = document.createElement('div');
            noteItem.className = 'note-item';
            noteItem.innerHTML = `
                <div class="note-date">${note.date} (Ng√†y: ${dayKey.split('-')[1]})</div>
                <div class="note-content">${note.content}</div>
            `;
            savedNotesContainer.appendChild(noteItem);
        });
    });
}

// G·ªçi h√†m renderNotes khi t·∫£i trang
renderNotes();


    </script>
</body>
</html>
